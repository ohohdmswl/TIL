## ìŠ¤í”„ë§ ì‹œíë¦¬í‹°(Spring Security) 
#ìŠ¤í”„ë§ì‹œíë¦¬í‹° #SPRING/SpringSecurity
- ì°¸ê³ URL
	- https://quiet-jun.tistory.com/26
	- https://velog.io/@ewan/Spring-Security-Custom-Authentication-Provider
	- https://velog.io/@backfox/%ED%86%A0%EC%9D%B4%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%ED%95%B4%EB%B0%A9%EC%9D%BC%EC%A7%80-3.-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0
	- https://substantial-park-a17.notion.site/JWT-7a5cd1cf278a407fae9f35166da5ab03
	- https://wikidocs.net/162150
- 


- 

ğŸ“Œ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°
- ì›¹ í”„ë¡œê·¸ë¨(ì• í”Œë¦¬ì¼€ì´ì…˜)ì˜ ë³´ì•ˆì„ ê°•í™”í•˜ê³  ì‚¬ìš©ì ì¸ì¦ ë° ê¶Œí•œ ë¶€ì—¬ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬ê°€ëŠ¥
- ì™¸ë¶€ ê³µê²©ìœ¼ë¡œë¶€í„° ì‹œìŠ¤í…œì„ ë³´í˜¸í•˜ëŠ” ë° ë„ì›€

 ğŸ·ï¸ @Configuration
- ì´ íŒŒì¼ì´ ìŠ¤í”„ë§ì˜ í™˜ê²½ ì„¤ì • íŒŒì¼ì„ì„ ì˜ë¯¸í•˜ëŠ” ì• ë„ˆí…Œì´ì…˜

ğŸ·ï¸ @EnableWebSecurity
- ëª¨ë“  ìš”ì²­ URLì´ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ì œì–´ë¥¼ ë°›ë„ë¡ ë§Œë“œëŠ” ì• ë„ˆí…Œì´ì…˜
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ë¥¼ í™œì„±í™”í•˜ëŠ” ì—­í• 
- ë‚´ë¶€ì ìœ¼ë¡œ SecurityFilterChain í´ë˜ìŠ¤ê°€ ë™ì‘í•˜ì—¬ ëª¨ë“  ìš”ì²­ URLì— ì´ í´ë˜ìŠ¤ê°€ í•„í„°ë¡œ ì ìš©ë˜ì–´ URLë³„ë¡œ íŠ¹ë³„í•œ ì„¤ì •ì„ í•  ìˆ˜ ìˆê²Œ ë¨

ğŸ·ï¸ @Bean
- SecurityFilterChain ë¹ˆì„ ìƒì„±í•´ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ì„¸ë¶€ ì„¤ì • ê°€ëŠ¥

âŒ¨ï¸ ì¸ì¦ë˜ì§€ ì•Šì€ ëª¨ë“  í˜ì´ì§€ ìš”ì²­ í—ˆë½(ë¡œê·¸ì¸ ì—†ì´ ëª¨ë“  í˜ì´ì§€ ì ‘ê·¼ ê°€ëŠ¥)
```java
http
    .authorizeHttpRequests((authorizeHttpRequests) -> authorizeHttpRequests
        .requestMatchers(new AntPathRequestMatcher("/**")).permitAll())
    ;
```

 ğŸ·ï¸ 403 Forbidden
- ì‘ë™ ì¤‘ì¸ ì„œë²„ì— í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì™”ìœ¼ë‚˜, ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ì ‘ê·¼ì„ ê±°ë¶€í–ˆì„ ë•Œ ë°˜í™˜í•˜ëŠ” HTTP ì˜¤ë¥˜ ì½”ë“œ
- ì„œë²„ ë˜ëŠ” ì„œë²„ì— ìˆëŠ” íŒŒì¼ ë“±ì— ì ‘ê·¼ ê¶Œí•œì´ ì—†ì„ ê²½ìš°ì— ë°œìƒ
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ CSRF ë°©ì–´ ê¸°ëŠ¥ì— ì˜í•´ ì ‘ê·¼ì´ ê±°ë¶€ë˜ê¸° ë•Œë¬¸


ğŸ·ï¸ CSRF
- ì›¹ ë³´ì•ˆ ê³µê²© ì¤‘ í•˜ë‚˜
- ì¡°ì‘ëœ ì •ë³´ë¡œ ì›¹ ì‚¬ì´íŠ¸ê°€ ì‹¤í–‰ë˜ë„ë¡ ì†ì´ëŠ” ê³µê²© ê¸°ìˆ 
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” ì´ëŸ¬í•œ ê³µê²©ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ CSRF í† í°ì„ ì„¸ì…˜ì„ í†µí•´ ë°œí–‰
- ì›¹ í˜ì´ì§€ì—ì„œëŠ” í¼ ì „ì†¡ ì‹œì— í•´ë‹¹ í† í°ì„ í•¨ê»˜ ì „ì†¡
- ì‹¤ì œ ì›¹ í˜ì´ì§€ì—ì„œ ì‘ì„±í•œ ë°ì´í„°ê°€ ì „ë‹¬ë˜ëŠ”ì§€ë¥¼ ê²€ì¦
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì— ì˜í•´ ì´ì™€ ê°™ì€ CSRF í† í°ì´ ìë™ìœ¼ë¡œ ìƒì„±
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” í˜ì´ì§€ì— CSRF í† í°ì„ ë°œí–‰í•˜ì—¬ ì´ ê°’ì´ ë‹¤ì‹œ ì„œë²„ë¡œ ì •í™•í•˜ê²Œ ë“¤ì–´ì˜¤ëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” ê³¼ì • ê°€ì§
- CSRF í† í°ì´ ì—†ê±°ë‚˜ í•´ì»¤ê°€ ì„ì˜ì˜ CSRF í† í°ì„ ê°•ì œë¡œ ë§Œë“¤ì–´ ì „ì†¡í•œë‹¤ë©´ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì— ì˜í•´ ì°¨ë‹¨ë¨


âŒ¨ï¸ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ê°€ CSRF ì˜ˆì™¸ì²˜ë¦¬ í•˜ëŠ” ì½”ë“œ
```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests((authorizeHttpRequests) -> authorizeHttpRequests
                .requestMatchers(new AntPathRequestMatcher("/**")).permitAll())
            .csrf((csrf) -> csrf
                .ignoringRequestMatchers(new AntPathRequestMatcher("/h2-console/**")))
        ;
        return http.build();
    }
```


ğŸ·ï¸ X-Frame-Options í—¤ë”
- í´ë¦­ì¬í‚¹ ê³µê²© ë§‰ê¸° ìœ„í•´ ì‚¬ìš©
- ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ëŠ” ì›¹ ì‚¬ì´íŠ¸ì˜ ì½˜í…ì¸ ê°€ ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì— í¬í•¨ë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ X-Frame-Options í—¤ë”ì˜ ê¸°ë³¸ê°’ì„ DENYë¡œ ì‚¬ìš©
- í”„ë ˆì„ êµ¬ì¡°ì˜ ì›¹ ì‚¬ì´íŠ¸ëŠ” ì´ í—¤ë”ì˜ ê°’ì´ DENYì¸ ê²½ìš° ì´ì™€ ê°™ì´ ì˜¤ë¥˜ê°€ ë°œìƒ

 ğŸ·ï¸í´ë¦­ì¬í‚¹
 - ì‚¬ìš©ìì˜ ì˜ë„ì™€ ë‹¤ë¥¸ ì‘ì—…ì´ ìˆ˜í–‰ë˜ë„ë¡ ì†ì´ëŠ” ë³´ì•ˆ ê³µê²© ê¸°ìˆ .


âŒ¨ï¸  X-Frame-Options ì˜¤ë¥˜ í•´ê²° ì½”ë“œ
```java
import org.springframework.security.web.header.writers.frameoptions.XFrameOptionsHeaderWriter;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests((authorizeHttpRequests) -> authorizeHttpRequests
                .requestMatchers(new AntPathRequestMatcher("/**")).permitAll())
            .csrf((csrf) -> csrf
                .ignoringRequestMatchers(new AntPathRequestMatcher("/h2-console/**")))
                
            .headers((headers) -> headers
                .addHeaderWriter(new XFrameOptionsHeaderWriter(
                    XFrameOptionsHeaderWriter.XFrameOptionsMode.SAMEORIGIN)))
        ;
        return http.build();
    }
}
```
- URL ìš”ì²­ ì‹œÂ `X-Frame-Options`Â í—¤ë”ë¥¼ DENY ëŒ€ì‹  SAMEORIGINìœ¼ë¡œ ì„¤ì •
- `X-Frame-Options`Â í—¤ë”ì˜ ê°’ìœ¼ë¡œ SAMEORIGINì„ ì„¤ì •
	- í”„ë ˆì„ì— í¬í•¨ëœ ì›¹ í˜ì´ì§€ê°€ ë™ì¼í•œ ì‚¬ì´íŠ¸ì—ì„œ ì œê³µí•  ë•Œì—ë§Œ ì‚¬ìš©ì´ í—ˆë½